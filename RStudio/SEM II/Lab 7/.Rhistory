model4=lm(expenditure~log(share)*age*income*dependents,data=train)
summary(model4)
pred4=model4%>%
predict(test)
RMSE(pred4,test$expenditure)
R2(pred4,test$expenditure)
pred5=model5%>%
predict(test)
model5=lm(expenditure~
income*share*months*active, data=train)
summary(model5)
pred5=model5%>%
predict(test)
RMSE(pred5,test$expenditure)
R2(pred5,test$expenditure)
plot(model5,1)
plot(model5,1)
plot(model5,2)
plot(model5,3)
plot(model5,4)
table(newdf$income_cat,newdf$card)
t=newdf%>%
filter(card=="no")
table(t$income_cat)
which.max(table(t$income_cat))
which.max(table(t$income_cat))[1]
which.max(table(t$income_cat))[[1]]
max(table(t$income_cat))
which.max(table(t$income_cat))[1]
max(table(t$income_cat))
View(newdf)
View(newdf)
newdf%>%
filter(income_cat=="low" & owner=="yes" & selfemp=="yes" & card=="yest")
newdf%>%
filter(income_cat=="low" & owner=="yes" & selfemp=="yes" & card=="yes")
median(d$share)
s=sample(df$income, size=15)
boxplot(s, main="Samples of Income")
View(newdf)
View(newdf)
model6=lm(expenditure~
card*income*share*selfemp*majorcards,data=train)
summary(model6)
pred6=model6%>%
predict(test)
pred6=model6%>%
predict(test)
RMSE(pred6,test$expenditure)
R2(pred6,test$expenditure)
model6=lm(expenditure~
card*income*selfemp*majorcards,data=train)
summary(model6)
pred6=model6%>%
predict(test)
RMSE(pred6,test$expenditure)
R2(pred6,test$expenditure)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(car)
library(car)
library(ggpubr)
data=read.csv("heart.csv")
colnames(data)[1]="age"
colnames(data)
#Converting the required columns to factors
str(data)
#Converting the required columns to factors
str(data)
data=data%>%
mutate(sex=replace(sex, sex==1, "Male"))
data=data%>%
mutate(sex=replace(sex, sex==1, "Male"))
data=data%>%
mutate(sex=replace(sex, sex==0, "Female"))
data=data%>%
mutate(sex=replace(sex, sex==0, "Female"))
data=data%>%
mutate(target=replace(target, target==1, "Yes"))
data=data%>%
mutate(sex=replace(sex, sex==1, "Male"))
data=data%>%
mutate(sex=replace(sex, sex==0, "Female"))
data=data%>%
mutate(target=replace(target, target==1, "Yes"))
data=data%>%
mutate(target=replace(target, target==0, "No"))
data=data%>%
mutate(sex=replace(sex, sex==1, "Male"))
data=data%>%
mutate(sex=replace(sex, sex==0, "Female"))
data=data%>%
mutate(target=replace(target, target==1, "Yes"))
data=data%>%
mutate(target=replace(target, target==0, "No"))
data$sex=as.factor(data$sex)
data$slope=as.character(data$slope)
data$slope=as.factor(data$slope)
str(data)
var.test(chol~slope, data=data, alternative="two.sided")
var.test(chol~sex, data=data, alternative="two.sided")
res=var.test(chol~slope,data)
res=var.test(chol~sex, data=data, alternative="two.sided")
res
res.ftest$estimate
res$estimate
res$p.value
Sys.Date()
Sys.time()
Sys.timezone()
as.Date("1979-03-21")
months("1979-03-21")
months("2020-8-6")
weekdays("2020-8-6")
d=as.Date("2020-8-6")
weekdays(d)
seq(d,by="2 months", length.out = 6)
library(ggplot2)
library(ggthemes)
library(lubridate)
install.packages(ggthemes)
"ggthemes"
install.packages("ggthemes")
library(ggthemes)
library(dplyr)
library(tidyr)
library(DT)
install.packages("DT")
library(DT)
library(scales)
colors = c(""#CC1011", "#665555", "#05a399", "#cfcaca", "#f5e840", "#0683c9", "#e075b0"")
exit
colors = c("#CC1011", "#665555", "#05a399", "#cfcaca", "#f5e840", "#0683c9", "#e075b0")
apr_data <- read.csv("uber-raw-data-apr14.csv")
apr_data <- read.csv("uber-raw-data-apr14.csv")
may_data <- read.csv("uber-raw-data-may14.csv")
apr_data <- read.csv("uber-raw-data-apr14.csv")
may_data <- read.csv("uber-raw-data-may14.csv")
jun_data <- read.csv("uber-raw-data-jun14.csv")
jul_data <- read.csv("uber-raw-data-jul14.csv")
jul_data <- read.csv("uber-raw-data-jul14.csv")
aug_data <- read.csv("uber-raw-data-aug14.csv")
sep_data <- read.csv("uber-raw-data-sep14.csv")
data_2014 <- rbind(apr_data,may_data, jun_data, jul_data, aug_data, sep_data)
data_2014$Date.Time <- as.POSIXct(data_2014$Date.Time, format = "%m/%d/%Y %H:%M:%S")
data_2014$hour <- factor(hour(hms(data_2014$Time)))
data_2014$hour <- factor(hour(hms(data_2014$Time)))
data_2014$minute <- factor(minute(hms(data_2014$Time)))
data_2014$second <- factor(second(hms(data_2014$Time)))
data_2014$Date.Time <- ymd_hms(data_2014$Date.Time)
data_2014$Date.Time <- ymd_hms(data_2014$Date.Time)
data_2014$hour <- factor(hour(hms(data_2014$Time)))
rm(list=ls())
library(ggplot2)
library(ggthemes)
library(lubridate)
library(dplyr)
library(tidyr)
library(DT)
library(scales)
colors = c("#CC1011", "#665555", "#05a399", "#cfcaca", "#f5e840", "#0683c9", "#e075b0")
apr_data <- read.csv("uber-raw-data-apr14.csv")
apr_data <- read.csv("uber-raw-data-apr14.csv")
may_data <- read.csv("uber-raw-data-may14.csv")
may_data <- read.csv("uber-raw-data-may14.csv")
jun_data <- read.csv("uber-raw-data-jun14.csv")
jul_data <- read.csv("uber-raw-data-jul14.csv")
aug_data <- read.csv("uber-raw-data-aug14.csv")
sep_data <- read.csv("uber-raw-data-sep14.csv")
data_2014 <- rbind(apr_data,may_data, jun_data, jul_data, aug_data, sep_data)
data_2014$Date.Time <- as.POSIXct(data_2014$Date.Time, format = "%m/%d/%Y %H:%M:%S")
data_2014$Time <- format(as.POSIXct(data_2014$Date.Time, format = "%m/%d/%Y %H:%M:%S"), format="%H:%M:%S")
data_2014$Date.Time <- ymd_hms(data_2014$Date.Time)
data_2014$day <- factor(day(data_2014$Date.Time))
data_2014$month <- factor(month(data_2014$Date.Time, label = TRUE))
data_2014$month <- factor(month(data_2014$Date.Time, label = TRUE))
data_2014$year <- factor(year(data_2014$Date.Time))
data_2014$year <- factor(year(data_2014$Date.Time))
data_2014$dayofweek <- factor(wday(data_2014$Date.Time, label = TRUE))
data_2014$hour <- factor(hour(hms(data_2014$Time)))
data_2014$minute <- factor(minute(hms(data_2014$Time)))
data_2014$minute <- factor(minute(hms(data_2014$Time)))
data_2014$second <- factor(second(hms(data_2014$Time)))
hour_data <- data_2014 %>%
group_by(hour) %>%
dplyr::summarize(Total = n())
datatable(hour_data)
ggplot(hour_data, aes(hour, Total)) +
geom_bar( stat = "identity", fill = "steelblue", color = "red") +
ggtitle("Trips Every Hour") +
theme(legend.position = "none") +
scale_y_continuous(labels = comma)
month_hour <- data_2014 %>%
group_by(month, hour) %>%
dplyr::summarize(Total = n())
ggplot(month_hour, aes(hour, Total, fill = month)) +
geom_bar( stat = "identity") +
ggtitle("Trips by Hour and Month") +
scale_y_continuous(labels = comma)
day_group <- data_2014 %>%
group_by(day) %>%
dplyr::summarize(Total = n())
datatable(day_group)
ggplot(day_group, aes(day, Total)) +
geom_bar( stat = "identity", fill = "steelblue") +
ggtitle("Trips Every Day") +
theme(legend.position = "none") +
scale_y_continuous(labels = comma)
day_month_group <- data_2014 %>%
group_by(month, day) %>%
dplyr::summarize(Total = n())
ggplot(day_month_group, aes(day, Total, fill = month)) +
geom_bar( stat = "identity") +
ggtitle("Trips by Day and Month") +
scale_y_continuous(labels = comma) +
scale_fill_manual(values = colors)
month_group <- data_2014 %>%
group_by(month) %>%
dplyr::summarize(Total = n())
datatable(month_group)
ggplot( month_group, aes(month, Total, fill = month)) +
geom_bar( stat = "identity") +
ggtitle("Trips by Month") +
theme(legend.position = "none") +
scale_y_continuous(labels = comma) +
scale_fill_manual(values = colors)
month_weekday <- data_2014 %>%
group_by(month, dayofweek) %>%
dplyr::summarize(Total = n())
ggplot(month_weekday, aes(month, Total, fill = dayofweek)) +
geom_bar( stat = "identity", position = "dodge") +
ggtitle("Trips by Day and Month") +
scale_y_continuous(labels = comma) +
scale_fill_manual(values = colors)
ggplot(data_2014, aes(Base)) +
geom_bar(fill = "darkred") +
scale_y_continuous(labels = comma) +
ggtitle("Trips by Bases")
ggplot(data_2014, aes(Base, fill = month)) +
geom_bar(position = "dodge") +
scale_y_continuous(labels = comma) +
ggtitle("Trips by Bases and Month") +
scale_fill_manual(values = colors)
ggplot(data_2014, aes(Base, fill = dayofweek)) +
geom_bar(position = "dodge") +
scale_y_continuous(labels = comma) +
ggtitle("Trips by Bases and DayofWeek") +
scale_fill_manual(values = colors)
day_and_hour <- data_2014 %>%
group_by(day, hour) %>%
dplyr::summarize(Total = n())
datatable(day_and_hour)
ggplot(day_and_hour, aes(day, hour, fill = Total)) +
geom_tile(color = "white") +
ggtitle("Heat Map by Hour and Day")
ggplot(day_month_group, aes(day, month, fill = Total)) +
geom_tile(color = "white") +
ggtitle("Heat Map by Month and Day")
ggplot(month_weekday, aes(dayofweek, month, fill = Total)) +
geom_tile(color = "white") +
ggtitle("Heat Map by Month and Day of Week")
setwd("C:/Code/RStudio/SEM II/Lab 7")
rm(list=ls())
data<- read.csv("USArrests.csv",row.names=1)
library(dplyr)
data1<- sample_n(data,20)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(0,Kmax)
nClust<- list()
for (i in 2:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
setwd("C:/Code/RStudio/SEM II/Lab 7")
rm(list=ls())
data<- read.csv("USArrests.csv",row.names=1)
library(dplyr)
data1<- sample_n(data,20)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 2:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(2:Kmax,WCSS,type="b",pch=19)
setwd("C:/Code/RStudio/SEM II/Lab 7")
rm(list=ls())
data<- read.csv("USArrests.csv",row.names=1)
library(dplyr)
data1<- sample_n(data,20)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 2:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(2:Kmax,WCSS,type="b",pch=19)
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
plot(1:Kmax,sil,type="b",pch=19)
rm(list=ls())
df<- scale(data1)
rm(list=ls())
data<- read.csv("USArrests.csv",row.names=1)
library(dplyr)
data1<- sample_n(data,30)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 2:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
plot(1:Kmax,sil,type="b",pch=19)
rm(list=ls())
data<- read.csv("USArrests.csv",row.names=1)
library(dplyr)
data1<- sample_n(data,40)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 2:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
plot(1:Kmax,sil,type="b",pch=19)
setwd("C:/Code/RStudio/SEM II/Lab 7")
rm(list=ls())
library(dplyr)
data1<- sample_n(data,40)
df<- scale(data1)
set.seed(112)
setwd("C:/Code/RStudio/SEM II/Lab 7")
rm(list=ls())
data<- read.csv("USArrests.csv",row.names=1)
library(dplyr)
data1<- sample_n(data,40)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 1:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
plot(1:Kmax,sil,type="b",pch=19)
data1<- sample_n(data,20)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 1:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
plot(1:Kmax,sil,type="b",pch=19)
data1<- sample_n(data,30)
df<- scale(data1)
set.seed(112)
fit<- kmeans(df,3)
fit$size
fit$withinss
fit$tot.withinss  # Within Cluster Sum of Squares (WCSS)
Kmax<- 15
WCSS <- rep(NA,Kmax)
nClust<- list()
for (i in 1:Kmax){
fit<- kmeans(df,i)
WCSS[i] <- fit$tot.withinss
nClust[[i]] <- fit$size
}
plot(1:Kmax,WCSS,type="b",pch=19)
# install.packages("factoextra")
library(factoextra)
fviz_nbclust(df, kmeans, method = "wss",k.max = 15)
# install.packages("cluster")
library(cluster)
Kmax<- 15
sil <- rep(0,Kmax)
for (i in 2:Kmax){
fit<- pam(df, i, metric = "manhattan")
print(fit$silinfo$avg.width)
sil[i] <- fit$silinfo$avg.width
}
plot(1:Kmax,sil,type="b",pch=19)
fit<- pam(df, 3, metric = "manhattan") # K-Medoids
